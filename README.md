# Deep-Learning-Fitness-Estimation-ECG
This project applies deep learning to estimate VO2max and other CRF metrics using resting ECG data from ~8,700 UK Biobank participants. By utilizing pre-trained PCLR embeddings and transfer learning, the model eliminates the need for costly and risky maximal exercise testing.

How I used the files:

1. create_fitness_params.py
   input:
   output:
   explanantion: Create .csv files with create create_fitness_params.py.
   
2. BP_mean.py
   Special case: blood pressure .csv files were creates with BP_mean.py as teh average of two measurements was calculated.
   
3. #.csv file was created with sex, age (from instace 2), BMI (from instance 2) from participants with a resting ECG data file from insatnce 2
4. PCLR embeddings were extracted and saved with create_pclr_emb.py


5. pclr_plus_different_models.py
   input:
   output: a) saves Full Models for all fitness parameters saved in /cluster/work/grlab/projects/tmp_imankowski/models
           b) prints evaluation metrics (r (95 %CI), R^2, MAE, MSE, RMSE)
   File creates a 'Full Model' (Input: Age, Sex, BMI, 320 ECG embeddings) with the Machine Learning techniques: Lasso, ElasicNet, XGBoost, MLP
   The Lasso Model was run and saved for all fitness metrics. It was saved under /cluster/work/grlab/projects/tmp_imankowski/models
   The other models (ElasicNet, XGBoost, MLP) were run and saved only for the VO2max
   The file also generated the evaluation metrics (r (95 %CI), R^2, MAE, MSE, RMSE)
   

6. basic_own_model.py creates a 'Basic Model' (Input: Age, Sex, BMI, 320 ECG embeddings) with the machine learning techniques: Lasso, ElasicNet, XGBoost, MLP
This file was used to generate the Basic Model for all machine learning techniques for the VO2max evaluation.

7. table_eval_fitness_smaples.py
   input:
   output: a) saves Basic Model for all fitness metrics in /cluster/work/grlab/projects/tmp_imankowski/models
           b) saves LaTeX code with tables for the results section of the written thesis
   For efficiency, the basic model was not run manually for every fitness parameter with basic_own_model.py.
   With the file table_eval_fitness_smaples.py the 'Basic Model' was run for  for every fitness parameter.
The Basic Models were saved under 
The file also used the saved 'Full Models' generated by pclr_plus_different_models.py that were saved in the models folder.
The output of table_eval_fitness_smaples.py was this the Basic Models and a LaTeX file with tables that summarises and compares the Basic Model and the Full Model.
Futher formating adjustments were undertaken in overleaf.

8. Figures
